_PATHS = {
    "reelBasePopulation" : "main/textFiles/Matis-Base_Population.csv",
    "basePopulation" : "main/textFilesTest/basePopulationTest.txt"
}


def premiereLigne(donnees, lines):
    '''
    on ajoute dans le dictionnaire de données les données permetant de référencé chaque colonne par exemple : les date de 1976 a 2020 et le num des departement ...

    Params :
        donnees (list(list())) : la liste de données
        lines (list) : contient chaque ligne du fichier basePopulation
    Returns :
        None
    '''
    #la premiere ligne
    firstRow = [lines[0].split(";")]
    firstRow = firstRow[0][0:38] #on retire fin de la ligne qui comnmence a CODGEO

    #nombre de lignes
    nbRows = len(firstRow)

    for iDonnee in range(nbRows):
        #on change tous les Ã© en é
        if "Ã©" in firstRow[iDonnee]:
            firstRow[iDonnee] = firstRow[iDonnee].replace("Ã©", "é")

        if "\ufeff" in firstRow[iDonnee]:
            firstRow[iDonnee] = firstRow[iDonnee].replace("\ufeff", "")
        
        #on ne garde que les années comme ca plus facile a voir
        if "Population en " in firstRow[iDonnee]:
            firstRow[iDonnee] = firstRow[iDonnee].replace(" ", "") #on delete les espace avant au milieu et apres
            firstRow[iDonnee] = firstRow[iDonnee].replace("Populationen", "") #il reste que Populationen avec la date, on enleve donc la partie en trop

        if firstRow[iDonnee].isdigit():
            firstRow[iDonnee] = int(firstRow[iDonnee])

    #on a ajouter toutes les info concernant la premiere ligne
    #il faut maintenant ajouter celles conceranant les valeurs en elles-meme
    donnees.append(firstRow)



def donneesReels(donnees, lines):
    nbRows = len(lines)
    for iValeur in range(1, nbRows):
        #une ligne du fichier texte sous forme de liste
        xLigne = lines[iValeur].split(";")
        nbCol = len(xLigne)

        #on supprime les \n a la fin de toutes les lignes excepté la derniere
        xLigne[-1] = xLigne[-1].replace("\n", "")

        for xValeurLigne in range(nbCol):
            if xLigne[xValeurLigne] == "":
                xLigne[xValeurLigne] = 0

            if xValeurLigne not in [0, 1, 2, 3]:
                xLigne[xValeurLigne] = int(xLigne[xValeurLigne])
    
        donnees.append(xLigne)


def creerDonneesBasePopulation(TEST):
    if TEST:
        file = open(_PATHS["basePopulation"], "r", encoding='utf-8')
    else:
        file = open(_PATHS["reelBasePopulation"], "r", encoding='utf-8')
    lines = file.readlines()
    lines.pop(1)
    donnees = [] #création de la liste de données
    premiereLigne(donnees, lines) # on ajoute les infos d'intitulé de colonne
    donneesReels(donnees, lines) # on rajoute les données propres
    file.close()
    return donnees